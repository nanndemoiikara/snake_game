{"version":3,"sources":["js/es6/snake.js"],"names":[],"mappings":"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","file":"js/es6/snake.js","sourcesContent":["'use strict';\nconst doc = document;\nconst privateNames = new WeakMap();\n//TODO:ここMap?\nconst Config = new Map();\nConfig.set('game_width',    300);\nConfig.set('game_height',   300);\nConfig.set('snake_size',    10);\nConfig.set('level_multi',   6);\nConfig.set('default_speed', 300);\nConfig.set('snake_color',   [252, 80, 77, 255]);\nConfig.set('food_color',    [88, 157, 80, 255]);\n\nclass SnakeGame {\n\n\tconstructor()\n\t{\n\t\tthis.init();\n\t}\n\n\tinit()\n\t{\n\t\tthis.snake_speed = Config.get('default_speed');\n\t\tthis.tmp_vector  = 2;\n\t\tthis.point       = 0;\n\t\tthis.live        = null;\n\t\tthis.Controller();\n\t}\n\n\t/**\n\t * Controller\n\t * DOMContentLoaded後の処理を書いている。。。要検討\n\t **/\n\tController()\n\t{\n\t\tthis.gameBodyElm = doc.getElementById('game_display');\n\t\tthis.canvas      = this.gameBodyElm.getContext('2d');\n\t\tthis.createBody();\n\n\t\tthis.snake = new Founder();\n\n\t\tvar snake_position = this.snake.getPosition();\n\t\tthis.render(snake_position.x, snake_position.y, Config.get('snake_color'));\n\t\tthis.createFood();\n\t\tdoc.addEventListener('keydown', (ev) => {\n\t\t\tif ( this.keyBinding(ev) &&  this.live === null ) this.animationCore();\n\t\t})\n\t}\n\n\t/**\n\t * KeyBoard Binding\n\t * @param EventObject ev\n\t * @return boolean\n\t **/\n\tkeyBinding(ev)\n\t{\n\t\tif ( this.live === false ) return false;\n\t\tswitch (ev.keyCode)\n\t\t{\n\t\t\tcase 37:\n\t\t\t\tthis.tmp_vector = 0;\n\t\t\t\tbreak;\n\n\t\t\tcase 38:\n\t\t\t\tthis.tmp_vector = 1;\n\t\t\t\tbreak;\n\n\t\t\tcase 39:\n\t\t\t\tthis.tmp_vector = 2;\n\t\t\t\tbreak;\n\n\t\t\tcase 40:\n\t\t\t\tthis.tmp_vector = 3;\n\t\t\t\tbreak;\n\n\t\t\tdefault :\n\t\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n\n\t/**\n\t * animationCore\n\t * アニメーションの管理 timerIdにsetTimeoutのidを突っ込んで再帰\n\t **/\n\tanimationCore()\n\t{\n\t\tthis.live = true;\n\n\t\tthis.timerId = setTimeout(()=>{\n\t\t\tthis.snake.positionUpdate(this.tmp_vector);\n\n\t\t\tlet snake_position = this.snake.getPosition(),\n\t\t\t\tsnake_stack    = this.snake.getStack(),\n\t\t\t\tfood_position  = this.food.getPosition(),\n\t\t\t\tsnake_color    = Config.get('snake_color');\n\n\t\t\t//foodを食べたときの処理\n\t\t\tif ( this.isEatColor(snake_position.x, snake_position.y, Config.get('food_color')) )\n\t\t\t{\n\t\t\t\tthis.levelUp();\n\t\t\t\tthis.createFood();\n\t\t\t\tfood_position = this.food.getPosition();\n\t\t\t}\n\t\t\telse if ( this.isGameOver(snake_position.x, snake_position.y) )\n\t\t\t{\n\t\t\t\treturn this.gameOver();\n\t\t\t}\n\n\t\t\tthis.clearCanvas();\n\t\t\tfor ( var i = 0; i < snake_stack.length; i++ )\n\t\t\t{\n\t\t\t\tthis.render(snake_stack[i].x, snake_stack[i].y, Config.get('snake_color'));\n\t\t\t}\n\t\t\tthis.render(food_position.x, food_position.y, Config.get('food_color'));\n\n\t\t\tthis.timerId = this.animationCore();\n\t\t}, this.snake_speed);\n\t}\n\n\t/**\n\t * Render\n\t * 描画を行う\n\t *\n\t * @param int x\n\t * @param int y\n\t **/\n\trender(x, y, color)\n\t{\n\t\tthis.canvas.beginPath();\n\t\tthis.canvas.fillStyle = 'rgba(' + color.join(',') + ')';\n\t\tthis.canvas.fillRect(\n\t\t\tx, y,\n\t\t\tConfig.get('snake_size'),\n\t\t\tConfig.get('snake_size')\n\t\t);\n\t}\n\n\t/**\n\t * isEatColor\n\t * 特定の色のマスに到達したかを検証\n\t *\n\t * @param int x\n\t * @param int y\n\t * @param Array food_rgba\n\t * @return bool\n\t **/\n\tisEatColor(x, y, food_rgba)\n\t{\n\t\tvar rgba = this.canvas.getImageData(x*2, y*2, 1, 1).data.values();\n\n\t\tfor ( let i = 0; i < food_rgba.length; i++ )\n\t\t{\n\t\t\tif ( food_rgba[i] != rgba.next().value ) return false;\n\t\t}\n\t\treturn true;\n\t}\n\n\t/**\n\t * createFood\n\t * 食物の生成\n\t **/\n\tcreateFood()\n\t{\n\t\tvar snake_position = this.snake.getPosition(),\n\t\t\tsnake_size     = Config.get('snake_size'),\n\t\t\tx_block_num    = Config.get('game_width') / snake_size,\n\t\t\ty_block_num    = Config.get('game_height') / snake_size,\n\t\t\tfood_x         = 0,\n\t\t\tfood_y         = 0;\n\n\t\tdo\n\t\t{\n\t\t\tfood_x = ( Math.floor( Math.random() * x_block_num ) * snake_size);\n\t\t\tfood_y = ( Math.floor( Math.random() * y_block_num ) * snake_size);\n\t\t}\n\t\twhile ( this.isEatColor(food_x, food_y, Config.get('snake_color')) )\n\n\t\tthis.food = undefined;\n\t\tthis.food = new Founder(food_x, food_y);\n\n\t\tthis.render(food_x, food_y, Config.get('food_color'));\n\t}\n\n\t/**\n\t * gameSet\n\t * ゲーム終了処理\n\t **/\n\tgameOver()\n\t{\n\t\tthis.live = false;\n\t\tclearTimeout(this.timerId);\n\t\twindow.alert('Game Over!! Game board click when retry');\n\n\t\t//addOne Time Event\n\t\tlet retryFunc = () => {\n\t\t\tif ( this.live === false ) this.init();\n\t\t\tthis.gameBodyElm.removeEventListener(retryFunc);\n\t\t}\n\n\t\tthis.gameBodyElm.addEventListener('click', retryFunc);\n\t}\n\n\t/**\n\t * isGameSet\n\t * ゲーム終了判定\n\t * @param int x\n\t * @param int y\n\t * @return bool\n\t **/\n\tisGameOver(x, y)\n\t{\n\t\treturn ( x >= Config.get('game_width')  || x <  0 \n\t\t\t  || y >= Config.get('game_height') || y < 0 \n\t\t\t  || this.isEatColor(x, y, Config.get('snake_color')));\n\t}\n\n\t/**\n\t * clearCanvas\n\t * キャンバスのクリア\n\t **/\n\tclearCanvas()\n\t{\n\t\tthis.canvas.clearRect(\n\t\t\t0, 0, \n\t\t\tConfig.get('game_width'), \n\t\t\tConfig.get('game_height')\n\t\t);\n\t}\n\n\tlevelUp()\n\t{\n\t\tvar snake_length = this.snake.updateStackLimit(6),\n\t\t\tnow_speed    = this.snake_speed,\n\t\t\ttmp_speed    = now_speed - Math.round( Config.get('default_speed') * 2 / snake_length );\n\n\t\tthis.updatePoint(snake_length);\n\t\tthis.snake_speed = ( tmp_speed <= 0 )? Math.round(now_speed / 2) : tmp_speed ;\n\t}\n\n\t/**\n\t * anmation用のcanvasにstyleのセット\n\t **/\n\tcreateBody()\n\t{\n\t\t//Fix Retina Display\n\t\tthis.gameBodyElm.setAttribute('width' , (Config.get('game_width') * 2));\n\t\tthis.gameBodyElm.setAttribute('height', (Config.get('game_height') * 2));\n\t\tthis.gameBodyElm.style.width           = Config.get('game_width') + 'px';\n\t\tthis.gameBodyElm.style.height          = Config.get('game_height') + 'px';\n\t\tthis.gameBodyElm.style.backgroundColor = '#000';\n\t\tthis.gameBodyElm.style.border          = '10px solid #DDD';\n\t\tthis.canvas.scale(2, 2);\n\n\t\tthis.pointBodyElm = doc.createElement('DIV');\n\t\tthis.pointBodyElm.id              = 'point_body';\n\t\tthis.pointBodyElm.style.width     = ( Config.get('game_width') + 20 ) + 'px';\n\t\tthis.pointBodyElm.style.textAlign = 'right';\n\t\tthis.pointBodyElm.style.fontFamily = '\"ヒラギノ角ゴ Pro W3\", \"Hiragino Kaku Gothic Pro\", \"メイリオ\", Meiryo, Osaka, \"ＭＳ Ｐゴシック\", \"MS PGothic\", sans-serif';\n\t\tthis.gameBodyElm.parentNode.insertBefore(this.pointBodyElm, this.gameBodyElm.nextSibling);\n\t\tthis.updatePoint();\n\t}\n\n\t/**\n\t * pointを更新するメソッド\n\t **/\n\tupdatePoint(num = 0)\n\t{\n\t\tthis.point += num;\n\n\t\tvar point_str = this.point;\n\t\tif ( this.pointBodyElm.textContent !== void(0) )\n\t\t{\n\t\t\tthis.pointBodyElm.textContent = point_str;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.pointBodyElm.innerText = point_str;\n\t\t}\n\t}\n}\n\nclass Founder {\n\n\t/**\n\t * constructor\n\t * @param int x\n\t * @param int y\n\t **/\n\tconstructor(x = 10, y = 10)\n\t{\n\t\tprivateNames.set(this,{\n\t\t\tposition : {x, y},\n\t\t\tvector   : 2,\n\t\t\tlength   : 1,\n\t\t\tstack    : []\n\t\t});\n\t}\n\n\t/**\n\t * positionUpdate\n\t * @param int vector\n\t **/\n\tpositionUpdate (vector = null)\n\t{\n\t\tconst size = Config.get('snake_size');\n\t\tlet p_data   = privateNames.get(this),\n\t\t\tx        = p_data.position.x,\n\t\t\ty        = p_data.position.y;\n\n\t\tif ( vector === null || p_data.vector == vector + 2 || p_data.vector == vector -2 ) vector = p_data.vector;\n\n\t\tif ( vector%2 == 0 )\n\t\t{\n\t\t\tx = ( vector > 0 )? x + size : x - size ;\n\t\t}\n\t\telse\n\t\t{\n\t\t\ty = ( vector > 1 )? y + size : y - size ;\n\t\t}\n\n\n\t\tlet length = p_data.stack.push({x, y});\n\n\t\tp_data.vector     = vector;\n\t\tp_data.position.y = y;\n\t\tp_data.position.x = x;\n\n\t\tif ( p_data.length < length ) p_data.stack.shift();\n\n\t\tprivateNames.set(this, p_data);\n\t}\n\n\t/**\n\t * getPosition\n\t * @return Object\n\t **/\n\tgetPosition()\n\t{\n\t\tlet p_data = privateNames.get(this);\n\t\treturn p_data.position;\n\t}\n\n\t/**\n\t * getStack\n\t * @return Array\n\t **/\n\tgetStack()\n\t{\n\t\tlet p_data = privateNames.get(this);\n\t\treturn p_data.stack;\n\t}\n\n\t/**\n\t * updateStackLimit\n\t * positionの保持量を加算する。\n\t * @param int num\n\t * @return int\n\t **/\n\tupdateStackLimit(num = 1)\n\t{\n\t\tlet p_data = privateNames.get(this);\n\t\tp_data.length += num;\n\t\tprivateNames.set(this, p_data);\n\t\treturn p_data.length;\n\t}\n}\n\ndoc.addEventListener('DOMContentLoaded',function(){\n\tnew SnakeGame();\n});\n"]}